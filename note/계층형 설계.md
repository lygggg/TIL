1. 그래프 가장 위에 있는 코드가 고치기 가장 쉽다.
2. 아래에 있는 코드는 테스트가 중요하다.
3. 아래 있는 코드가 더 재사용하기 쉽다.

### map() 함수 도출하기
```ts
function emailsForCustomers(customers, goods, bests) {
	var email = [];
	forEach(customers, function(customer) {
		var email = emailForCustomer(customer, goods, bests);
		emails.push(email);
		})
		return emails;
}
```

### 콜백으로 빼내기
```ts
function emailsForCustomers(customers, goods, bests) {
		return map(customers, function(customer) {
		return emailForCustomer(customer, goods, bests);
		})
}


function map(array, f) {
	var newArray = [];
	forEach(array, function(element) {
		newArray.push(f(element));
	})
	return newArray;
}
```


### 함수를 전달하는 세 가지 방법

### 전역으로 정의하기
```ts
function greet(name) {
	return "Hello, " + name;
}
```
### 지역적으로 정의하기
```ts
function greetEverybody(friends) {
	var greeting;
	if(language === "English")
		greeting = "Hello, ";
	else
		greeting = "Salut, ";

	var greet = function(name) {
		return greeting + name;
	}

	return map(friends, greet);
}
```
### 인라인으로 정의하기
```ts
var friendGreetings = map(friendsNames, function(name) {
	return "Hello, " + name;
})
```


- map은 매우 중요한 함수다. 함수형 프로그래머는 map을 항상 조심해야 한다.
- map은 단순하기 떄문에 함수형 프로그래머들이 좋아한다. 하지만 리턴값이 있는 배열에 들어있는 항목을 확인하지 않기 떄문에 조심해야 한다.
- 고객 데이터에 이메일이 없어서 customer.email 값이 null이나 undefined면 어떻게 될까? 결과 배열 안에 null이 들어갈 것이다.
- 자바스크립트라면 null을 허용하는 언어이므로 가끔 null이 생긴다. 조심해서 사용하거나, null을 허용하지 않는 언어를 사용해야한다.

### 함수형 도구: filter()
```ts
function filter(array, f) {
	var newArray = [];
	forEach(array, function(element) {
		if(f(element))
		newArray.push(element);
	});
	return newArray;
}
```

